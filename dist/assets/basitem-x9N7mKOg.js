import{_ as ae,g as S,r as f,k as te,s as oe,h as d,G as ne,o as c,c as _,a as F,b as a,e as M,w as t,F as x,m as k,i as m,H as re,l as se,q as R,E as v,A as ue}from"./index-DvIhe9Wx.js";import{g as de,a as ie,d as pe,c as me,u as ge}from"./basitem-DN7lMiTl.js";const ce={class:"basitem-management"},be={class:"action-bar"},fe={class:"pagination-container"},_e={__name:"basitem",setup(ve){const q=["件","套","个","块","根","袋","箱","捆","托","纸箱"],N=["标件","标准件","锻件","铝件","玛铁件","耐火","燃料","铜铝件","油二","油一","铸件"],C=[{id:10,value:"原料"},{id:20,value:"成品"},{id:30,value:"半成品"},{id:40,value:"废料"},{id:100,value:"其它"}],E=r=>{const l=C.find(s=>s.id===r);return l?l.value:"未知"},n=S({itemNo:"",itemName:"",type:"",inclass:"",pageNumber:1,pageSize:10}),B=f([]),z=f(0),h=f(!1),b=f(!1),U=f("add"),L=te(()=>U.value==="add"?"新增物料":"编辑物料"),V=f(null),o=S({id:void 0,no:"",name:"",unit:"",spec:"",description:"",color:"",memo:"",type:10,weight:0,keeper_rule:"",planned_price:0,avg_price:0,location:"",tech_memo:"",status:0,inclass:"",isdelete:0}),O={no:[{required:!0,message:"请输入物料编号",trigger:"blur"},{max:50,message:"长度不能超过50个字符",trigger:"blur"}],name:[{required:!0,message:"请输入物料名称",trigger:"blur"},{max:50,message:"长度不能超过50个字符",trigger:"blur"}],unit:[{max:50,message:"长度不能超过50个字符",trigger:"blur"}],spec:[{max:50,message:"长度不能超过50个字符",trigger:"blur"}],description:[{max:50,message:"长度不能超过50个字符",trigger:"blur"}],color:[{max:50,message:"长度不能超过50个字符",trigger:"blur"}],memo:[{max:100,message:"长度不能超过100个字符",trigger:"blur"}],type:[{required:!0,message:"请选择物料类型",trigger:"change"},{type:"number",message:"请选择有效的物料类型",trigger:["blur","change"]}],weight:[{type:"number",message:"请输入有效的数字",trigger:["blur","change"]}],planned_price:[{type:"number",message:"请输入有效的数字",trigger:["blur","change"]}],avg_price:[{type:"number",message:"请输入有效的数字",trigger:["blur","change"]}],location:[{max:50,message:"长度不能超过50个字符",trigger:"blur"}],tech_memo:[{max:100,message:"长度不能超过100个字符",trigger:"blur"}],inclass:[{max:50,message:"长度不能超过50个字符",trigger:"blur"}]},i=async()=>{h.value=!0;try{const r=await de(n);B.value=r.data.page.list,z.value=r.data.page.totalRow}catch(r){console.error("获取物料列表失败",r),v.error("获取物料列表失败")}finally{h.value=!1}},T=r=>{n.pageSize=r,i()},D=r=>{n.pageNumber=r,i()},$=()=>{V.value&&V.value.resetFields(),Object.assign(o,{id:void 0,no:"",name:"",unit:"",spec:"",description:"",color:"",memo:"",type:10,weight:0,keeper_rule:"",planned_price:0,avg_price:0,location:"",tech_memo:"",status:0,inclass:"",isdelete:0})},j=()=>{n.itemNo="",n.itemName="",n.type="",n.inclass="",n.pageNumber=1,i()},K=()=>{U.value="add",b.value=!0},A=async r=>{U.value="edit";const l=await ie({id:r.id});Object.assign(o,l.data.basItem),b.value=!0},P=r=>{ue.confirm(`确认删除物料"${r.no}"吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await pe({id:r.id}),v.success("删除成功"),i()}catch(l){console.error("删除物料失败",l),v.error("删除物料失败")}}).catch(()=>{})},G=()=>{V.value&&V.value.validate(async r=>{if(r)try{U.value==="add"?(await me(o),v.success("新增成功")):(await ge(o),v.success("修改成功")),b.value=!1,i()}catch(l){console.error("保存物料失败",l),v.error("保存物料失败")}})};return oe(()=>{i()}),(r,l)=>{const s=d("el-input"),y=d("el-option"),w=d("el-select"),g=d("el-button"),H=d("Refresh"),J=d("el-icon"),p=d("el-table-column"),Q=d("el-table"),W=d("el-pagination"),u=d("el-form-item"),I=d("el-col"),X=d("el-row"),Y=d("el-form"),Z=d("el-dialog"),ee=ne("loading");return c(),_("div",ce,[F("div",be,[a(s,{modelValue:n.itemNo,"onUpdate:modelValue":l[0]||(l[0]=e=>n.itemNo=e),placeholder:"请输入物料编号查询",style:{width:"200px","margin-right":"10px"},clearable:"",onClear:i,onKeyup:M(i,["enter"])},null,8,["modelValue"]),a(s,{modelValue:n.itemName,"onUpdate:modelValue":l[1]||(l[1]=e=>n.itemName=e),placeholder:"请输入物料名称查询",style:{width:"200px","margin-right":"10px"},clearable:"",onClear:i,onKeyup:M(i,["enter"])},null,8,["modelValue"]),a(w,{modelValue:n.inclass,"onUpdate:modelValue":l[2]||(l[2]=e=>n.inclass=e),placeholder:"选择物料所属分类",style:{width:"200px","margin-right":"10px"}},{default:t(()=>[(c(),_(x,null,k(N,e=>a(y,{key:e,label:e,value:e},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),a(w,{modelValue:n.type,"onUpdate:modelValue":l[3]||(l[3]=e=>n.type=e),placeholder:"选择物料类型",style:{width:"200px","margin-right":"10px"}},{default:t(()=>[(c(),_(x,null,k(C,e=>a(y,{key:e.id,label:e.value,value:e.id},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),a(g,{type:"primary",onClick:i},{default:t(()=>l[22]||(l[22]=[m("搜索")])),_:1}),a(g,{type:"warning",onClick:j},{default:t(()=>[a(J,null,{default:t(()=>[a(H)]),_:1}),l[23]||(l[23]=m(" 刷新 "))]),_:1}),a(g,{type:"primary",style:{"margin-left":"auto"},onClick:K},{default:t(()=>l[24]||(l[24]=[m("新增物料")])),_:1})]),re((c(),se(Q,{data:B.value,border:"",style:{width:"100%"}},{default:t(()=>[a(p,{type:"index",label:"序号",width:"80"}),a(p,{prop:"no",label:"物料编号"}),a(p,{prop:"spec",label:"规格型号"}),a(p,{prop:"name",label:"物料名称"}),a(p,{prop:"unit",label:"计量单位"}),a(p,{prop:"planned_price",label:"计划价格"}),a(p,{prop:"type",label:"物料类型",width:"120"},{default:t(({row:e})=>[m(R(E(e.type)),1)]),_:1}),a(p,{prop:"inclass",label:"所属分类"}),a(p,{prop:"status",label:"状态",width:"100"},{default:t(({row:e})=>[m(R(e.status===0?"正常":"停用"),1)]),_:1}),a(p,{label:"操作",width:"200"},{default:t(({row:e})=>[a(g,{type:"primary",size:"small",onClick:le=>A(e)},{default:t(()=>l[25]||(l[25]=[m("编辑")])),_:2},1032,["onClick"]),a(g,{type:"danger",size:"small",onClick:le=>P(e)},{default:t(()=>l[26]||(l[26]=[m("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[ee,h.value]]),F("div",fe,[a(W,{"current-page":n.pageNumber,"onUpdate:currentPage":l[4]||(l[4]=e=>n.pageNumber=e),"page-size":n.pageSize,"onUpdate:pageSize":l[5]||(l[5]=e=>n.pageSize=e),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:z.value,onSizeChange:T,onCurrentChange:D},null,8,["current-page","page-size","total"])]),a(Z,{title:L.value,modelValue:b.value,"onUpdate:modelValue":l[21]||(l[21]=e=>b.value=e),width:"800px",onClosed:$},{footer:t(()=>[a(g,{onClick:l[20]||(l[20]=e=>b.value=!1)},{default:t(()=>l[27]||(l[27]=[m("取消")])),_:1}),a(g,{type:"primary",onClick:G},{default:t(()=>l[28]||(l[28]=[m("确定")])),_:1})]),default:t(()=>[a(Y,{ref_key:"formRef",ref:V,model:o,rules:O,"label-width":"100px"},{default:t(()=>[a(X,{gutter:20},{default:t(()=>[a(I,{span:12},{default:t(()=>[a(u,{label:"物料编号",prop:"no"},{default:t(()=>[a(s,{modelValue:o.no,"onUpdate:modelValue":l[6]||(l[6]=e=>o.no=e),placeholder:"请输入物料编号"},null,8,["modelValue"])]),_:1}),a(u,{label:"物料名称",prop:"name"},{default:t(()=>[a(s,{modelValue:o.name,"onUpdate:modelValue":l[7]||(l[7]=e=>o.name=e),placeholder:"请输入物料名称"},null,8,["modelValue"])]),_:1}),a(u,{label:"计量单位",prop:"unit"},{default:t(()=>[a(w,{modelValue:o.unit,"onUpdate:modelValue":l[8]||(l[8]=e=>o.unit=e),placeholder:"请选择或输入单位","allow-create":"",filterable:""},{default:t(()=>[(c(),_(x,null,k(q,e=>a(y,{key:e,label:e,value:e},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),a(u,{label:"物料类型",prop:"type"},{default:t(()=>[a(w,{modelValue:o.type,"onUpdate:modelValue":l[9]||(l[9]=e=>o.type=e),placeholder:"请选择物料类型"},{default:t(()=>[(c(),_(x,null,k(C,e=>a(y,{key:e.id,label:e.value,value:e.id},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),a(u,{label:"所属分类",prop:"inclass"},{default:t(()=>[a(w,{modelValue:o.inclass,"onUpdate:modelValue":l[10]||(l[10]=e=>o.inclass=e),placeholder:"请选择或输入分类","allow-create":"",filterable:""},{default:t(()=>[(c(),_(x,null,k(N,e=>a(y,{key:e,label:e,value:e},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),a(u,{label:"规格型号",prop:"spec"},{default:t(()=>[a(s,{modelValue:o.spec,"onUpdate:modelValue":l[11]||(l[11]=e=>o.spec=e),placeholder:"请输入规格型号"},null,8,["modelValue"])]),_:1}),a(u,{label:"物料描述",prop:"description"},{default:t(()=>[a(s,{modelValue:o.description,"onUpdate:modelValue":l[12]||(l[12]=e=>o.description=e),placeholder:"请输入物料描述"},null,8,["modelValue"])]),_:1})]),_:1}),a(I,{span:12},{default:t(()=>[a(u,{label:"颜色",prop:"color"},{default:t(()=>[a(s,{modelValue:o.color,"onUpdate:modelValue":l[13]||(l[13]=e=>o.color=e),placeholder:"请输入颜色"},null,8,["modelValue"])]),_:1}),a(u,{label:"重量",prop:"weight"},{default:t(()=>[a(s,{modelValue:o.weight,"onUpdate:modelValue":l[14]||(l[14]=e=>o.weight=e),modelModifiers:{number:!0},placeholder:"请输入重量",type:"number"},null,8,["modelValue"])]),_:1}),a(u,{label:"计划价格",prop:"planned_price"},{default:t(()=>[a(s,{modelValue:o.planned_price,"onUpdate:modelValue":l[15]||(l[15]=e=>o.planned_price=e),modelModifiers:{number:!0},placeholder:"请输入计划价格",type:"number"},null,8,["modelValue"])]),_:1}),a(u,{label:"平均价格",prop:"avg_price"},{default:t(()=>[a(s,{modelValue:o.avg_price,"onUpdate:modelValue":l[16]||(l[16]=e=>o.avg_price=e),modelModifiers:{number:!0},placeholder:"请输入平均价格",type:"number"},null,8,["modelValue"])]),_:1}),a(u,{label:"存放位置",prop:"location"},{default:t(()=>[a(s,{modelValue:o.location,"onUpdate:modelValue":l[17]||(l[17]=e=>o.location=e),placeholder:"请输入存放位置"},null,8,["modelValue"])]),_:1}),a(u,{label:"技术参数",prop:"tech_memo"},{default:t(()=>[a(s,{modelValue:o.tech_memo,"onUpdate:modelValue":l[18]||(l[18]=e=>o.tech_memo=e),placeholder:"请输入技术参数"},null,8,["modelValue"])]),_:1}),a(u,{label:"备注信息",prop:"memo"},{default:t(()=>[a(s,{modelValue:o.memo,"onUpdate:modelValue":l[19]||(l[19]=e=>o.memo=e),placeholder:"请输入备注信息"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])])}}},we=ae(_e,[["__scopeId","data-v-aa5e076e"]]);export{we as default};
