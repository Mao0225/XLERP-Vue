import{g as F,u as T}from"./querentongzhi-BpnJcUgi.js";import{_ as B,g as U,r as s,s as E,h as d,o as R,c as $,b as e,w as a,a as h,i as y,E as g}from"./index-Bwbtb0V1.js";const I={class:"chakantongzhi"},P={class:"pagination-container"},j={__name:"chakanshenhetongzhi",props:{noticeid:{type:String,required:!0}},setup(z){const p=U({noticeid:z.noticeid,pageNumber:1,pageSize:10}),f=s([]),_=s(0),c=s(!1),o=s({}),v=s(null),S=U({no:[{required:!0,message:"请输入合同编号",trigger:"blur"}],noticeid:[{required:!0,message:"请输入通知编号",trigger:"blur"}],noticename:[{required:!0,message:"请输入通知名称",trigger:"blur"}],noticebuilddate:[{required:!0,message:"请选择通知创建日期",trigger:"change"}]}),C=(u,l,n)=>{if(!n)return"";const m=new Date(n),V=m.getFullYear(),i=String(m.getMonth()+1).padStart(2,"0"),r=String(m.getDate()).padStart(2,"0");return`${V}-${i}-${r}`},b=async()=>{try{const u=await F(p);u.success?(f.value=u.data.page.list,_.value=u.data.page.totalRow):g.error(u.msg||"获取通知详情失败")}catch(u){console.error("获取通知详情失败:",u),g.error("获取通知详情失败")}},D=u=>{p.pageSize=u,p.pageNumber=1,b()},k=u=>{p.pageNumber=u,b()},N=async()=>{if(v.value)try{await v.value.validate();const u={...o.value,noticebuilddate:o.value.noticebuilddate?new Date(o.value.noticebuilddate).getTime():null},l=await T(u);l.success?(g.success("更新成功"),c.value=!1,b()):g.error(l.msg||"更新失败")}catch(u){console.log("表单验证失败:",u),g.warning("请检查并填写必填字段")}};return E(()=>{b()}),(u,l)=>{const n=d("el-table-column"),m=d("el-table"),V=d("el-pagination"),i=d("el-input"),r=d("el-form-item"),Y=d("el-input-number"),x=d("el-date-picker"),M=d("el-form"),w=d("el-button"),q=d("el-dialog");return R(),$("div",I,[e(m,{data:f.value,border:"",style:{width:"100%"}},{default:a(()=>[e(n,{prop:"itemno",label:"产品型号"}),e(n,{prop:"spec",label:"规格"}),e(n,{prop:"itemnum",label:"数量"}),e(n,{prop:"unit",label:"单位"}),e(n,{prop:"noticeid",label:"通知编号"}),e(n,{prop:"noticename",label:"通知名称"}),e(n,{prop:"noticedeliver",label:"通知校验人"}),e(n,{prop:"noticeauther",label:"通知作者"}),e(n,{prop:"noticeinstead",label:"通知替代型号"}),e(n,{prop:"noticedrawno",label:"通知图纸编号"}),e(n,{prop:"noticecomment",label:"通知备注"}),e(n,{prop:"noticeshenhe",label:"通知审核者"}),e(n,{prop:"name",label:"名称"}),e(n,{prop:"noticebuilddate",label:"通知创建日期",formatter:C})]),_:1},8,["data"]),h("div",P,[e(V,{"current-page":p.pageNumber,"onUpdate:currentPage":l[0]||(l[0]=t=>p.pageNumber=t),"page-size":p.pageSize,"onUpdate:pageSize":l[1]||(l[1]=t=>p.pageSize=t),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:_.value,onSizeChange:D,onCurrentChange:k},null,8,["current-page","page-size","total"])]),e(q,{modelValue:c.value,"onUpdate:modelValue":l[17]||(l[17]=t=>c.value=t),title:"编辑通知详情"},{footer:a(()=>[e(w,{onClick:l[16]||(l[16]=t=>c.value=!1)},{default:a(()=>l[18]||(l[18]=[y("取消")])),_:1}),e(w,{type:"primary",onClick:N},{default:a(()=>l[19]||(l[19]=[y("保存")])),_:1})]),default:a(()=>[e(M,{model:o.value,rules:S,ref_key:"editFormRef",ref:v,"label-width":"120px"},{default:a(()=>[e(r,{label:"物料编号",prop:"itemno"},{default:a(()=>[e(i,{modelValue:o.value.itemno,"onUpdate:modelValue":l[2]||(l[2]=t=>o.value.itemno=t)},null,8,["modelValue"])]),_:1}),e(r,{label:"规格",prop:"spec"},{default:a(()=>[e(i,{modelValue:o.value.spec,"onUpdate:modelValue":l[3]||(l[3]=t=>o.value.spec=t)},null,8,["modelValue"])]),_:1}),e(r,{label:"数量",prop:"itemnum"},{default:a(()=>[e(Y,{modelValue:o.value.itemnum,"onUpdate:modelValue":l[4]||(l[4]=t=>o.value.itemnum=t),min:0},null,8,["modelValue"])]),_:1}),e(r,{label:"单位",prop:"unit"},{default:a(()=>[e(i,{modelValue:o.value.unit,"onUpdate:modelValue":l[5]||(l[5]=t=>o.value.unit=t)},null,8,["modelValue"])]),_:1}),e(r,{label:"通知编号",prop:"noticeid"},{default:a(()=>[e(i,{modelValue:o.value.noticeid,"onUpdate:modelValue":l[6]||(l[6]=t=>o.value.noticeid=t)},null,8,["modelValue"])]),_:1}),e(r,{label:"通知名称",prop:"noticename"},{default:a(()=>[e(i,{modelValue:o.value.noticename,"onUpdate:modelValue":l[7]||(l[7]=t=>o.value.noticename=t)},null,8,["modelValue"])]),_:1}),e(r,{label:"通知校验人",prop:"noticedeliver"},{default:a(()=>[e(i,{modelValue:o.value.noticedeliver,"onUpdate:modelValue":l[8]||(l[8]=t=>o.value.noticedeliver=t)},null,8,["modelValue"])]),_:1}),e(r,{label:"通知作者",prop:"noticeauther"},{default:a(()=>[e(i,{modelValue:o.value.noticeauther,"onUpdate:modelValue":l[9]||(l[9]=t=>o.value.noticeauther=t)},null,8,["modelValue"])]),_:1}),e(r,{label:"通知替代型号",prop:"noticeinstead"},{default:a(()=>[e(i,{modelValue:o.value.noticeinstead,"onUpdate:modelValue":l[10]||(l[10]=t=>o.value.noticeinstead=t)},null,8,["modelValue"])]),_:1}),e(r,{label:"通知图纸编号",prop:"noticedrawno"},{default:a(()=>[e(i,{modelValue:o.value.noticedrawno,"onUpdate:modelValue":l[11]||(l[11]=t=>o.value.noticedrawno=t)},null,8,["modelValue"])]),_:1}),e(r,{label:"通知备注",prop:"noticecomment"},{default:a(()=>[e(i,{type:"textarea",modelValue:o.value.noticecomment,"onUpdate:modelValue":l[12]||(l[12]=t=>o.value.noticecomment=t),rows:4},null,8,["modelValue"])]),_:1}),e(r,{label:"通知审核者",prop:"noticeshenhe"},{default:a(()=>[e(i,{modelValue:o.value.noticeshenhe,"onUpdate:modelValue":l[13]||(l[13]=t=>o.value.noticeshenhe=t)},null,8,["modelValue"])]),_:1}),e(r,{label:"名称",prop:"name"},{default:a(()=>[e(i,{modelValue:o.value.name,"onUpdate:modelValue":l[14]||(l[14]=t=>o.value.name=t)},null,8,["modelValue"])]),_:1}),e(r,{label:"通知创建日期",prop:"noticebuilddate"},{default:a(()=>[e(x,{modelValue:o.value.noticebuilddate,"onUpdate:modelValue":l[15]||(l[15]=t=>o.value.noticebuilddate=t),type:"date",placeholder:"选择日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}},G=B(j,[["__scopeId","data-v-f392ce0d"]]);export{G as C};
