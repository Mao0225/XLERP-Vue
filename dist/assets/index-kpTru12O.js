import{O as k,P as H,Q,R as J,_ as W,g as M,r as C,k as X,s as Y,h as p,G as Z,o as U,c as ee,a as D,b as e,e as le,w as a,i as c,H as ae,l as oe,E as m,A as te}from"./index-DivwvCM9.js";function de(g){return k("/baspurchaseorder/getpage",g)}function re(g){return k("/baspurchaseorder/get",g)}function ue(g){return H("/baspurchaseorder/save",g)}function se(g){return Q("/baspurchaseorder/update",g)}function ne(g){return J("/baspurchaseorder/delete",g)}const pe={class:"purchaseorder-management"},me={class:"action-bar"},ie={class:"pagination-container"},fe={__name:"index",setup(g){const n=M({poNo:"",pageNumber:1,pageSize:10}),y=C([]),x=C(0),w=C(!1),N=C(!1),v=C("add"),z=X(()=>v.value==="add"?"新增采购订单":"编辑采购订单"),_=C(null),t=M({id:void 0,poNo:"",poItemNo:"",poItemId:"",subclassCode:"",subclassName:"",conCode:"",conName:"",buyerName:"",buyerCode:"",materialCode:"",materialDesc:"",amount:"",sellerConCode:"",serialNumber:"",sellerSignTime:"",conType:void 0,prjCode:"",prjName:"",matCode:"",fixedTechId:"",pkgNo:"",bidBatCode:"",extDes:"",matMaxCode:"",matMedCode:"",matMinCode:"",matMaxName:"",matMedName:"",matMinName:"",modifyTime:""}),B={poNo:[{required:!0,message:"请输入采购订单编码",trigger:"blur"},{min:1,max:48,message:"长度在 1 到 48 个字符",trigger:"blur"}],subclassName:[{required:!0,message:"请输入种类名称",trigger:"blur"},{min:1,max:48,message:"长度在 1 到 48 个字符",trigger:"blur"}],conName:[{max:200,message:"合同名称长度不能超过 200 个字符",trigger:"blur"}],buyerName:[{max:200,message:"采购方公司名称长度不能超过 200 个字符",trigger:"blur"}],materialDesc:[{max:255,message:"物料描述长度不能超过 255 个字符",trigger:"blur"}],extDes:[{max:2400,message:"固化ID描述长度不能超过 2400 个字符",trigger:"blur"}]},b=async()=>{w.value=!0;try{const s={...n};console.log("请求参数:",s);const l=await de(s);console.log("后端返回数据:",l),l.success?(y.value=l.data.page.list,x.value=l.data.page.totalRow,console.log("采购订单列表:",y.value),console.log("总记录数:",x.value)):m.error(l.msg||"获取采购订单列表失败")}catch(s){console.error("获取采购订单列表失败:",s),m.error("获取采购订单列表失败")}finally{w.value=!1}},h=s=>{n.pageSize=s,n.pageNumber=1,console.log("分页大小变更:",n.pageSize),b()},I=s=>{n.pageNumber=s,console.log("当前页变更:",n.pageNumber),b()},j=()=>{_.value&&_.value.resetFields(),Object.keys(t).forEach(s=>{s==="id"||s==="conType"?t[s]=void 0:t[s]=""})},O=()=>{v.value="add",N.value=!0},T=async s=>{v.value="edit";try{const l=await re({id:s.id});console.log("获取采购订单信息:",l),l.success?(Object.assign(t,l.data.basPurchaseOrder),N.value=!0):m.error(l.msg||"获取采购订单信息失败")}catch(l){console.error("获取采购订单信息失败:",l),m.error("获取采购订单信息失败")}},P=s=>{te.confirm(`确认删除采购订单"${s.poNo}"吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const l=await ne({id:s.id});l.success?(m.success("删除成功"),b()):m.error(l.msg||"删除采购订单失败")}catch(l){console.error("删除采购订单失败:",l),m.error("删除采购订单失败")}}).catch(()=>{})},S=()=>{n.poNo="",n.pageNumber=1,b()},R=()=>{_.value&&_.value.validate(async s=>{if(s)try{const l={...t};if(console.log("提交表单数据:",l),v.value==="add"){const d=await ue(l);d.success?m.success("新增成功"):m.error(d.msg||"新增采购订单失败")}else{const d=await se(l);d.success?m.success("修改成功"):m.error(d.msg||"修改采购订单失败")}N.value=!1,b()}catch(l){console.error("保存采购订单失败:",l),m.error("保存采购订单失败")}})};return Y(()=>{b()}),(s,l)=>{const d=p("el-input"),V=p("el-button"),$=p("Refresh"),E=p("el-icon"),i=p("el-table-column"),F=p("el-table"),q=p("el-pagination"),r=p("el-form-item"),u=p("el-col"),f=p("el-row"),A=p("el-form"),K=p("el-dialog"),L=Z("loading");return U(),ee("div",pe,[D("div",me,[e(d,{modelValue:n.poNo,"onUpdate:modelValue":l[0]||(l[0]=o=>n.poNo=o),placeholder:"请输入采购订单号搜索",style:{width:"200px","margin-right":"10px"},clearable:"",onClear:l[1]||(l[1]=o=>b()),onKeyup:l[2]||(l[2]=le(o=>b(),["enter"]))},null,8,["modelValue"]),e(V,{type:"primary",onClick:l[3]||(l[3]=o=>b())},{default:a(()=>l[30]||(l[30]=[c("搜索")])),_:1}),e(V,{type:"warning",onClick:S},{default:a(()=>[e(E,null,{default:a(()=>[e($)]),_:1}),l[31]||(l[31]=c(" 刷新 "))]),_:1}),e(V,{type:"primary",style:{"margin-left":"auto"},onClick:O},{default:a(()=>l[32]||(l[32]=[c("新增采购订单")])),_:1})]),ae((U(),oe(F,{data:y.value,border:"",style:{width:"100%"}},{default:a(()=>[e(i,{type:"index",label:"序号",width:"80"}),e(i,{prop:"poNo",label:"采购订单编码",width:"150"}),e(i,{prop:"poItemNo",label:"行项目号",width:"120"}),e(i,{prop:"subclassName",label:"种类名称",width:"120"}),e(i,{prop:"conName",label:"合同名称",width:"200","show-overflow-tooltip":""}),e(i,{prop:"buyerName",label:"采购方公司",width:"180","show-overflow-tooltip":""}),e(i,{prop:"materialDesc",label:"物料描述",width:"200","show-overflow-tooltip":""}),e(i,{prop:"amount",label:"采购数量",width:"100"}),e(i,{prop:"prjName",label:"工程项目",width:"180","show-overflow-tooltip":""}),e(i,{prop:"createTime",label:"创建时间",width:"160"}),e(i,{label:"操作",width:"180",fixed:"right"},{default:a(({row:o})=>[e(V,{type:"primary",size:"small",onClick:G=>T(o)},{default:a(()=>l[33]||(l[33]=[c("编辑")])),_:2},1032,["onClick"]),e(V,{type:"danger",size:"small",onClick:G=>P(o)},{default:a(()=>l[34]||(l[34]=[c("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[L,w.value]]),D("div",ie,[e(q,{"current-page":n.pageNumber,"onUpdate:currentPage":l[4]||(l[4]=o=>n.pageNumber=o),"page-size":n.pageSize,"onUpdate:pageSize":l[5]||(l[5]=o=>n.pageSize=o),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:x.value,onSizeChange:h,onCurrentChange:I},null,8,["current-page","page-size","total"])]),e(K,{title:z.value,modelValue:N.value,"onUpdate:modelValue":l[29]||(l[29]=o=>N.value=o),width:"80%",onClosed:j},{footer:a(()=>[e(V,{onClick:l[28]||(l[28]=o=>N.value=!1)},{default:a(()=>l[35]||(l[35]=[c("取消")])),_:1}),e(V,{type:"primary",onClick:R},{default:a(()=>l[36]||(l[36]=[c("确定")])),_:1})]),default:a(()=>[e(A,{ref_key:"formRef",ref:_,model:t,rules:B,"label-width":"120px"},{default:a(()=>[e(f,{gutter:20},{default:a(()=>[e(u,{span:12},{default:a(()=>[e(r,{label:"采购订单编码",prop:"poNo"},{default:a(()=>[e(d,{modelValue:t.poNo,"onUpdate:modelValue":l[6]||(l[6]=o=>t.poNo=o),placeholder:"请输入采购订单编码"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(r,{label:"行项目号",prop:"poItemNo"},{default:a(()=>[e(d,{modelValue:t.poItemNo,"onUpdate:modelValue":l[7]||(l[7]=o=>t.poItemNo=o),placeholder:"请输入行项目号"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(f,{gutter:20},{default:a(()=>[e(u,{span:12},{default:a(()=>[e(r,{label:"种类编码",prop:"subclassCode"},{default:a(()=>[e(d,{modelValue:t.subclassCode,"onUpdate:modelValue":l[8]||(l[8]=o=>t.subclassCode=o),placeholder:"请输入种类编码"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(r,{label:"种类名称",prop:"subclassName"},{default:a(()=>[e(d,{modelValue:t.subclassName,"onUpdate:modelValue":l[9]||(l[9]=o=>t.subclassName=o),placeholder:"请输入种类名称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(f,{gutter:20},{default:a(()=>[e(u,{span:12},{default:a(()=>[e(r,{label:"合同序号",prop:"conCode"},{default:a(()=>[e(d,{modelValue:t.conCode,"onUpdate:modelValue":l[10]||(l[10]=o=>t.conCode=o),placeholder:"请输入合同序号"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(r,{label:"合同名称",prop:"conName"},{default:a(()=>[e(d,{modelValue:t.conName,"onUpdate:modelValue":l[11]||(l[11]=o=>t.conName=o),placeholder:"请输入合同名称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(f,{gutter:20},{default:a(()=>[e(u,{span:12},{default:a(()=>[e(r,{label:"采购方公司名称",prop:"buyerName"},{default:a(()=>[e(d,{modelValue:t.buyerName,"onUpdate:modelValue":l[12]||(l[12]=o=>t.buyerName=o),placeholder:"请输入采购方公司名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(r,{label:"采购方公司编码",prop:"buyerCode"},{default:a(()=>[e(d,{modelValue:t.buyerCode,"onUpdate:modelValue":l[13]||(l[13]=o=>t.buyerCode=o),placeholder:"请输入采购方公司编码"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(f,{gutter:20},{default:a(()=>[e(u,{span:12},{default:a(()=>[e(r,{label:"物料编码",prop:"materialCode"},{default:a(()=>[e(d,{modelValue:t.materialCode,"onUpdate:modelValue":l[14]||(l[14]=o=>t.materialCode=o),placeholder:"请输入物料编码"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(r,{label:"采购数量",prop:"amount"},{default:a(()=>[e(d,{modelValue:t.amount,"onUpdate:modelValue":l[15]||(l[15]=o=>t.amount=o),placeholder:"请输入采购数量"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(f,{gutter:20},{default:a(()=>[e(u,{span:24},{default:a(()=>[e(r,{label:"物料描述",prop:"materialDesc"},{default:a(()=>[e(d,{modelValue:t.materialDesc,"onUpdate:modelValue":l[16]||(l[16]=o=>t.materialDesc=o),type:"textarea",placeholder:"请输入物料描述"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(f,{gutter:20},{default:a(()=>[e(u,{span:12},{default:a(()=>[e(r,{label:"项目序号",prop:"prjCode"},{default:a(()=>[e(d,{modelValue:t.prjCode,"onUpdate:modelValue":l[17]||(l[17]=o=>t.prjCode=o),placeholder:"请输入项目序号"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(r,{label:"工程项目名称",prop:"prjName"},{default:a(()=>[e(d,{modelValue:t.prjName,"onUpdate:modelValue":l[18]||(l[18]=o=>t.prjName=o),placeholder:"请输入工程项目名称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(f,{gutter:20},{default:a(()=>[e(u,{span:12},{default:a(()=>[e(r,{label:"物资编码",prop:"matCode"},{default:a(()=>[e(d,{modelValue:t.matCode,"onUpdate:modelValue":l[19]||(l[19]=o=>t.matCode=o),placeholder:"请输入物资编码"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(r,{label:"合同包号",prop:"pkgNo"},{default:a(()=>[e(d,{modelValue:t.pkgNo,"onUpdate:modelValue":l[20]||(l[20]=o=>t.pkgNo=o),placeholder:"请输入合同包号"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(f,{gutter:20},{default:a(()=>[e(u,{span:8},{default:a(()=>[e(r,{label:"物资大类编码",prop:"matMaxCode"},{default:a(()=>[e(d,{modelValue:t.matMaxCode,"onUpdate:modelValue":l[21]||(l[21]=o=>t.matMaxCode=o),placeholder:"请输入物资大类编码"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:8},{default:a(()=>[e(r,{label:"物资中类编码",prop:"matMedCode"},{default:a(()=>[e(d,{modelValue:t.matMedCode,"onUpdate:modelValue":l[22]||(l[22]=o=>t.matMedCode=o),placeholder:"请输入物资中类编码"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:8},{default:a(()=>[e(r,{label:"物资小类编码",prop:"matMinCode"},{default:a(()=>[e(d,{modelValue:t.matMinCode,"onUpdate:modelValue":l[23]||(l[23]=o=>t.matMinCode=o),placeholder:"请输入物资小类编码"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(f,{gutter:20},{default:a(()=>[e(u,{span:8},{default:a(()=>[e(r,{label:"物资大类名称",prop:"matMaxName"},{default:a(()=>[e(d,{modelValue:t.matMaxName,"onUpdate:modelValue":l[24]||(l[24]=o=>t.matMaxName=o),placeholder:"请输入物资大类名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:8},{default:a(()=>[e(r,{label:"物资中类名称",prop:"matMedName"},{default:a(()=>[e(d,{modelValue:t.matMedName,"onUpdate:modelValue":l[25]||(l[25]=o=>t.matMedName=o),placeholder:"请输入物资中类名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:8},{default:a(()=>[e(r,{label:"物资小类名称",prop:"matMinName"},{default:a(()=>[e(d,{modelValue:t.matMinName,"onUpdate:modelValue":l[26]||(l[26]=o=>t.matMinName=o),placeholder:"请输入物资小类名称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(f,{gutter:20},{default:a(()=>[e(u,{span:24},{default:a(()=>[e(r,{label:"固化ID描述",prop:"extDes"},{default:a(()=>[e(d,{modelValue:t.extDes,"onUpdate:modelValue":l[27]||(l[27]=o=>t.extDes=o),type:"textarea",placeholder:"请输入固化ID描述"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])])}}},be=W(fe,[["__scopeId","data-v-f587a319"]]);export{be as default};
