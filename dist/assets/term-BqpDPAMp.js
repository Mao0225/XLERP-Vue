import{O as o,y as m,E as t}from"./index-Bwbtb0V1.js";function l(){return o("/term/getall")}const h=m("term",{state:()=>({terms:[],currentTerm:null,term:null,loading:!1,error:null}),actions:{async fetchTerms(){this.loading=!0,this.error=null;try{const e=await l();if(console.log("fetchTerms: API response",e),e.success){this.terms=e.data.list||[],console.log("fetchTerms: terms loaded",this.terms);const s=this.terms.find(r=>r.iscurrent===1);if(s)this.term=s.term,this.currentTerm||(this.currentTerm=this.term),console.log("获取期间，存储当前期间和当前选中的区间",{term:this.term,currentTerm:this.currentTerm});else if(this.terms.length>0&&!this.currentTerm){const r=this.terms.reduce((i,n)=>n.id>i.id?n:i,this.terms[0]);this.term=r.term,this.currentTerm=r.term,console.log("没有当前期间设置id最大的为当前区间",this.term)}else this.terms.length===0&&(this.error="未找到可用期间",t.warning("未找到可用期间，请联系管理员"))}else this.error=e.data.msg||"获取期间失败",t.error(this.error)}catch(e){this.error=e.message||"网络错误",t.error("获取期间列表失败: "+this.error)}finally{this.loading=!1}},setCurrentTerm(e){console.log("setCurrentTerm: new term value",e),this.currentTerm=e,t.success(`当前期间已切换为: ${e}`)}}});export{h as u};
