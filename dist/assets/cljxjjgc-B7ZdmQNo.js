import{_ as Le,f as Ye,k as Je,r as f,g as ue,s as Ae,h as V,G as Ge,o as v,c as g,a as y,b as t,w as r,i as u,W as se,H as He,l as Qe,q as c,F as de,m as me,p as N,x as Ke,ah as Xe,E as w,A as Ze,B as el}from"./index-DivwvCM9.js";import{g as ll,a as pe,b as tl,d as al,c as ol,u as rl}from"./clnzxjgc-uy8AQehh.js";import{a as il}from"./file-DG1x66KO.js";import{W as fe,S as ve,C as nl,I as ul}from"./SupplierDialog-CBSDge13.js";import"./plshengchangongdan-x5Bc9PHG.js";import"./basorg-CEO7C1K8.js";const sl={class:"clxcxjfc-management"},dl={class:"action-bar"},ml=["onClick"],pl={class:"pagination-container"},fl={key:0,class:"el-form-item__error"},vl={key:0,class:"el-form-item__error"},cl={key:0,class:"el-form-item__error"},gl={key:0,class:"el-form-item__error"},yl={key:0,class:"el-form-item__error"},wl={key:0,class:"el-form-item__error"},bl={key:0,class:"el-form-item__error"},Vl={key:0,class:"el-form-item__error"},Nl={key:0,class:"uploaded-files"},Cl={key:0,class:"preview-container"},Sl=["src"],hl={key:1,class:"preview-container"},kl=["src"],xl=["href"],Ml={key:2,class:"preview-container"},Ul={style:{"text-align":"center",padding:"40px"}},$l={__name:"cljxjjgc",setup(zl){const ce=Ye(),Q=Je(()=>({username:ce.realName||"未登录"})),U=el,i=f(W()),m=ue({mafactory:"",matRecheckNo:"",woNo:"",pageNumber:1,pageSize:10}),F=f([]),K=f(0),L=f(!1),M=f(!1),Y=f("新增耐张线夹钢材"),J=f("add"),P=f(null),A=f(!1),d=ue({}),$=f(!1),T=f(!1),B=f(!1),q=f(!1),z=f(!1),D=f(!1),X=()=>{B.value=!0},Z=()=>{q.value=!0},ge=a=>{i.value.contractNo=a.contractNo,B.value=!1},ye=a=>{i.value.ipoNo=a.ipoNo,q.value=!1},G=f(null),h=f([]),E=f(!1),k=f(""),R=f(""),_=f("");function ee(a){if(!a)return[];try{const e=JSON.parse(a);return Array.isArray(e)?e.map(o=>({...o,url:o.url.startsWith("http")?o.url:U+o.url})):[]}catch{return console.warn("Failed to parse certificate JSON for display:",a),[]}}function C(a){if(a==null||a==="")return"-";const e=Number(a);return isNaN(e)?a:e.toFixed(3)+"%"}const b=a=>{if(!i.value[a])return;const e=i.value[a].toString().trim(),o=Number(e);if(isNaN(o)){d[a]="请输入有效的数字";return}if(o<0||o>100){d[a]="值必须在0-100之间";return}i.value[a]=o.toFixed(3),d[a]=""};function W(){return{id:void 0,mafactory:"",batch:"",orderno:"",matMaterial:"",matSpec:"",matRecheckNo:"",chemC:"",chemSi:"",chemMn:"",chemP:"",chemS:"",chemCr:"",chemNi:"",chemMo:"",leavefactoryDate:"",detectionTime:"",certificate:"[]",contractNo:"",woNo:"",ipoNo:"",writer:"",writeTime:"",basno:"",flag:"",status:"",memo:"",type:""}}const we={mafactory:[{required:!0,message:"请选择原材料制造商",trigger:"change"}],batch:[{required:!0,message:"请填写炉批号",trigger:"blur"}],orderno:[{required:!0,message:"请填写入库单号",trigger:"blur"}],matMaterial:[{required:!0,message:"请填写牌号",trigger:"blur"}],matSpec:[{required:!0,message:"请填写规格",trigger:"blur"}],matRecheckNo:[{required:!0,message:"请填写来料检验批次号",trigger:"blur"}],chemC:[{required:!0,trigger:"blur",validator:(a,e,o)=>{e?isNaN(Number(e))?o(new Error("请输入有效的数字")):o():o(new Error("请填写化学成分C含量"))}}],chemSi:[{required:!0,trigger:"blur",validator:(a,e,o)=>{e?isNaN(Number(e))?o(new Error("请输入有效的数字")):o():o(new Error("请填写化学成分Si含量"))}}],chemMn:[{required:!0,trigger:"blur",validator:(a,e,o)=>{e?isNaN(Number(e))?o(new Error("请输入有效的数字")):o():o(new Error("请填写化学成分Mn含量"))}}],chemP:[{required:!0,trigger:"blur",validator:(a,e,o)=>{e?isNaN(Number(e))?o(new Error("请输入有效的数字")):o():o(new Error("请填写化学成分P含量"))}}],chemS:[{required:!0,trigger:"blur",validator:(a,e,o)=>{e?isNaN(Number(e))?o(new Error("请输入有效的数字")):o():o(new Error("请填写化学成分S含量"))}}],leavefactoryDate:[{required:!0,message:"请选择原材料出厂检测日期",trigger:"change"}],detectionTime:[{required:!0,message:"请选择原材料入厂检测日期",trigger:"change"}],certificate:[{required:!0,message:"请上传质量证明书",trigger:"change"}],woNo:[{max:50,message:"请选择生产工单号",trigger:"change"}],contractNo:[{required:!0,message:"合同编号不能为空",trigger:"change"}],ipoNo:[{max:50,message:"生产订单号不能为空",trigger:"change"}],writer:[{required:!0,message:"录入人不能为空",trigger:"blur"}],basno:[{max:50,message:"请获取单据号",trigger:"blur"}]},be=()=>{!m.matRecheckNo&&!m.matMaterial&&!m.orderno&&S()},S=async()=>{L.value=!0;try{const a=await ll(m);F.value=a.data.page.list,K.value=a.data.page.totalRow,F.value.length>0?console.log("第一条数据的单据号:",F.value[0].basno):console.log("列表为空")}catch{w.error("获取数据失败")}finally{L.value=!1}},I=()=>{m.mafactory="",m.matRecheckNo="",m.woNo="",m.pageNumber=1,S()},Ve=a=>{m.pageSize=a,S()},Ne=a=>{m.pageNumber=a,S()},Ce=async()=>{if(Y.value="新增耐张线夹钢材",J.value="add",i.value=W(),i.value.writer=Q.value.username,i.value.writeTime=oe(new Date),O.value)i.value.basno=O.value,O.value="";else try{const a=await pe("cljxjjgc");a.code===200?i.value.basno=a.data.fullNoNyName:w.warning("获取单据号失败，可手动填写")}catch(a){console.error("获取单据号异常",a),w.error("获取单据号失败")}h.value=[],i.value.certificate="[]",Object.keys(d).forEach(a=>{d[a]=""}),M.value=!0},Se=async a=>{Y.value="编辑耐张线夹钢材",J.value="edit";try{const e=await tl({id:a.id});e&&e.code===200&&e.data&&e.data.clNzxjGc&&(i.value={...W(),...e.data.clNzxjGc}),h.value=ee(i.value.certificate),M.value=!0}catch(e){console.error("获取详情失败",e),w.error("获取详情失败")}},he=a=>{Ze.confirm("确认删除该条钢材数据吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{await al({id:a.id}),w.success("删除成功"),I()}).catch(()=>{})},le=()=>{T.value=!0},ke=a=>{m.mafactory=a,$.value=!1},xe=a=>{m.woNo=a.woNo,D.value=!1},Me=()=>{m.mafactory=""},Ue=()=>{m.woNo=""},$e=a=>{i.value.mafactory=a,z.value=!1},ze=async a=>{i.value.woNo=a.woNo,T.value=!1},De=a=>{const e=ae(a.url,a.name);e==="image"||e==="pdf"?Ee(a.url,a.name,e):H(a.url,a.name)},Ee=(a,e="",o="")=>{const n=a.startsWith("http")?a:U+a;k.value=n,_.value=e,R.value=o||ae(n,e),E.value=!0},H=(a,e="")=>{try{const o=a.startsWith("http")?a:U+a,n=document.createElement("a");n.href=o,n.download=e||"质量证明书",n.target="_blank",document.body.appendChild(n),n.click(),document.body.removeChild(n),w.success("文件下载已开始")}catch(o){console.error("下载文件失败:",o),w.error("文件下载失败，请稍后重试"),window.open(a.startsWith("http")?a:U+a,"_blank")}},te=()=>{E.value=!1,k.value="",_.value="",R.value=""},je=()=>{w.error("图片加载失败")},Fe=()=>{w.error("PDF预览失败，请尝试下载文件")},ae=(a,e="")=>{const o=a||e;return/\.(jpg|jpeg|png|gif|bmp|webp)$/i.test(o)?"image":/\.pdf$/i.test(o)?"pdf":"other"},Pe=async a=>{if(h.value.length>=3){w.warning("最多只能上传3个质量证明书"),G.value.clearFiles();return}const e=new FormData;e.append("file",a.raw);try{const o=await il(e);if(o.success&&o.data&&o.data.url){const n=U+o.data.url,s=JSON.parse(i.value.certificate||"[]");s.push({name:a.name,url:n}),i.value.certificate=JSON.stringify(s),h.value.push({name:a.name,url:n}),w.success(`${a.name} 上传成功`)}else throw new Error(o.msg||"文件上传失败")}catch(o){console.error("文件上传失败",o),w.error(`${a.name} 上传失败`),G.value.clearFiles()}},Te=a=>{const e=JSON.parse(i.value.certificate||"[]");e.splice(a,1),i.value.certificate=JSON.stringify(e),h.value.splice(a,1)};function oe(a){if(!a)return"";const e=new Date(a),o=n=>n.toString().padStart(2,"0");return`${e.getFullYear()}-${o(e.getMonth()+1)}-${o(e.getDate())} ${o(e.getHours())}:${o(e.getMinutes())}:${o(e.getSeconds())}`}const Be=()=>{P.value.validate(async a=>{if(!a)return;const e=["chemC","chemSi","chemMn","chemP","chemS","chemCr","chemNi","chemMo"];let o=!1;if(e.forEach(n=>{if(i.value[n]&&i.value[n].toString().trim()!==""){const s=i.value[n].toString().trim(),j=Number(s);isNaN(j)?(d[n]="请输入有效的数字",o=!0):(j<0||j>100)&&(d[n]="值必须在0-100之间",o=!0)}}),o){w.warning("请检查化学分析字段输入是否正确");return}A.value=!0;try{if(i.value.certificate=JSON.stringify(h.value),!i.value.basno){w.error("单据号未生成，请刷新重试");return}if(J.value==="add"){i.value.writer=Q.value.username,i.value.writeTime=oe(new Date),await ol(i.value),w.success("新增成功");try{const n=await pe("cljxjgc");n.code===200&&(O.value=n.data.fullNoNyName)}catch(n){console.error("获取新单据号异常",n)}I()}else await rl(i.value),w.success("修改成功"),I();M.value=!1,S()}catch(n){console.error("保存失败:",n),w.error("保存失败: "+(n.message||"请检查数据格式"))}finally{A.value=!1}})},O=f(""),qe=()=>{i.value=W(),h.value=[],Object.keys(d).forEach(a=>{d[a]=""}),te(),P.value&&P.value.resetFields()};return Ae(()=>{S()}),(a,e)=>{const o=V("el-button"),n=V("el-input"),s=V("el-table-column"),j=V("el-table"),Re=V("el-pagination"),p=V("el-form-item"),re=V("el-date-picker"),_e=V("el-upload"),We=V("el-form"),ie=V("el-dialog"),Ie=V("el-icon"),Oe=Ge("loading");return v(),g("div",sl,[y("div",dl,[t(n,{modelValue:m.mafactory,"onUpdate:modelValue":e[1]||(e[1]=l=>m.mafactory=l),placeholder:"原材料制造商",readonly:"",style:{width:"200px","margin-right":"10px",cursor:"pointer"},onClick:e[2]||(e[2]=se(l=>$.value=!0,["stop"])),"suffix-icon":"el-icon-search",clearable:"",onClear:Me},{append:r(()=>[t(o,{onClick:e[0]||(e[0]=l=>$.value=!0),size:"small"},{default:r(()=>e[61]||(e[61]=[u("选择")])),_:1})]),_:1},8,["modelValue"]),t(n,{modelValue:m.matRecheckNo,"onUpdate:modelValue":e[3]||(e[3]=l=>m.matRecheckNo=l),placeholder:"来料检验批次号",style:{width:"180px","margin-right":"10px"},clearable:"",onClear:S,onInput:be},null,8,["modelValue"]),t(n,{modelValue:m.woNo,"onUpdate:modelValue":e[5]||(e[5]=l=>m.woNo=l),placeholder:"生产工单号",readonly:"",style:{width:"200px","margin-right":"10px",cursor:"pointer"},onClick:e[6]||(e[6]=se(l=>D.value=!0,["stop"])),"suffix-icon":"el-icon-search",clearable:"",onClear:Ue},{append:r(()=>[t(o,{onClick:e[4]||(e[4]=l=>D.value=!0),size:"small"},{default:r(()=>e[62]||(e[62]=[u("选择")])),_:1})]),_:1},8,["modelValue"]),t(o,{type:"primary",onClick:S},{default:r(()=>e[63]||(e[63]=[u("搜索")])),_:1}),t(o,{type:"warning",onClick:I,style:{"margin-left":"10px"}},{default:r(()=>e[64]||(e[64]=[u("重置")])),_:1}),t(o,{type:"primary",style:{"margin-left":"auto"},onClick:Ce},{default:r(()=>e[65]||(e[65]=[u("新增耐张线夹钢材")])),_:1})]),He((v(),Qe(j,{data:F.value,border:"",style:{width:"100%"},height:"calc(100vh - 250px)"},{default:r(()=>[t(s,{type:"index",label:"序号",width:"70"}),t(s,{prop:"basno",label:"单据号"}),t(s,{prop:"mafactory",label:"原材料制造商",width:"150"}),t(s,{prop:"batch",label:"炉批号",width:"120"}),t(s,{prop:"orderno",label:"入库单号",width:"150"}),t(s,{prop:"matMaterial",label:"牌号",width:"100"}),t(s,{prop:"matSpec",label:"规格",width:"120"}),t(s,{prop:"matRecheckNo",label:"来料检验批次号",width:"150"}),t(s,{prop:"chemC",label:"化学成分C(%)",width:"130"},{default:r(({row:l})=>[u(c(C(l.chemC)),1)]),_:1}),t(s,{prop:"chemSi",label:"化学成分Si(%)",width:"130"},{default:r(({row:l})=>[u(c(C(l.chemSi)),1)]),_:1}),t(s,{prop:"chemMn",label:"化学成分Mn(%)",width:"130"},{default:r(({row:l})=>[u(c(C(l.chemMn)),1)]),_:1}),t(s,{prop:"chemP",label:"化学成分P(%)",width:"130"},{default:r(({row:l})=>[u(c(C(l.chemP)),1)]),_:1}),t(s,{prop:"chemS",label:"化学成分S(%)",width:"130"},{default:r(({row:l})=>[u(c(C(l.chemS)),1)]),_:1}),t(s,{prop:"chemCr",label:"化学成分Cr(%)",width:"130"},{default:r(({row:l})=>[u(c(C(l.chemCr)),1)]),_:1}),t(s,{prop:"chemNi",label:"化学成分Ni(%)",width:"130"},{default:r(({row:l})=>[u(c(C(l.chemNi)),1)]),_:1}),t(s,{prop:"chemMo",label:"化学成分Mo(%)",width:"130"},{default:r(({row:l})=>[u(c(C(l.chemMo)),1)]),_:1}),t(s,{prop:"leavefactoryDate",label:"出厂检测日期",width:"120"}),t(s,{prop:"detectionTime",label:"入厂检测日期",width:"120"}),t(s,{label:"质量证明书",width:"180"},{default:r(({row:l})=>[(v(!0),g(de,null,me(ee(l.certificate),(x,ne)=>(v(),g("div",{key:ne},[y("span",{class:"file-link",onClick:Dl=>De(x)},c(x.name),9,ml)]))),128))]),_:1}),t(s,{prop:"contractNo",label:"合同编号",width:"150"}),t(s,{prop:"woNo",label:"生产工单号",width:"150"}),t(s,{prop:"ipoNo",label:"生产订单号",width:"150"}),t(s,{prop:"writer",label:"录入人",width:"100"}),t(s,{prop:"writeTime",label:"录入时间",width:"160"}),t(s,{label:"操作",width:"150",fixed:"right"},{default:r(({row:l})=>[t(o,{type:"primary",size:"small",onClick:x=>Se(l)},{default:r(()=>e[66]||(e[66]=[u("编辑")])),_:2},1032,["onClick"]),t(o,{type:"danger",size:"small",onClick:x=>he(l)},{default:r(()=>e[67]||(e[67]=[u("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[Oe,L.value]]),y("div",pl,[t(Re,{"current-page":m.pageNumber,"onUpdate:currentPage":e[7]||(e[7]=l=>m.pageNumber=l),"page-size":m.pageSize,"onUpdate:pageSize":e[8]||(e[8]=l=>m.pageSize=l),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:K.value,onSizeChange:Ve,onCurrentChange:Ne},null,8,["current-page","page-size","total"])]),t(ie,{title:Y.value,modelValue:M.value,"onUpdate:modelValue":e[52]||(e[52]=l=>M.value=l),width:"700px",onClosed:qe},{footer:r(()=>[t(o,{onClick:e[49]||(e[49]=l=>M.value=!1)},{default:r(()=>e[91]||(e[91]=[u("取消")])),_:1}),t(o,{type:"primary",onClick:Be,loading:A.value},{default:r(()=>e[92]||(e[92]=[u("保存")])),_:1},8,["loading"])]),default:r(()=>[t(We,{ref_key:"formRef",ref:P,model:i.value,rules:we,"label-width":"150px"},{default:r(()=>[t(p,{label:"生产工单号",prop:"woNo"},{default:r(()=>[t(n,{modelValue:i.value.woNo,"onUpdate:modelValue":e[9]||(e[9]=l=>i.value.woNo=l),placeholder:"请选择生产工单号",readonly:"",style:{width:"calc(100% - 80px)"},onClick:le},{append:r(()=>[t(o,{onClick:le,size:"small"},{default:r(()=>e[68]||(e[68]=[u("选择")])),_:1})]),_:1},8,["modelValue"])]),_:1}),t(p,{label:"合同编号",prop:"contractNo"},{default:r(()=>[t(n,{modelValue:i.value.contractNo,"onUpdate:modelValue":e[10]||(e[10]=l=>i.value.contractNo=l),placeholder:"请选择合同编号",readonly:"",onClick:X},{append:r(()=>[t(o,{onClick:X,size:"small"},{default:r(()=>e[69]||(e[69]=[u("选择")])),_:1})]),_:1},8,["modelValue"])]),_:1}),t(p,{label:"生产订单号",prop:"ipoNo"},{default:r(()=>[t(n,{modelValue:i.value.ipoNo,"onUpdate:modelValue":e[11]||(e[11]=l=>i.value.ipoNo=l),placeholder:"请选择生产订单号",readonly:"",onClick:Z},{append:r(()=>[t(o,{onClick:Z,size:"small"},{default:r(()=>e[70]||(e[70]=[u("选择")])),_:1})]),_:1},8,["modelValue"])]),_:1}),t(p,{label:"单据号",prop:"basno"},{default:r(()=>[t(n,{modelValue:i.value.basno,"onUpdate:modelValue":e[12]||(e[12]=l=>i.value.basno=l),placeholder:"自动生成",readonly:""},null,8,["modelValue"])]),_:1}),t(p,{label:"原材料制造商",prop:"mafactory"},{default:r(()=>[t(n,{modelValue:i.value.mafactory,"onUpdate:modelValue":e[14]||(e[14]=l=>i.value.mafactory=l),placeholder:"请选择原材料制造商",readonly:"",style:{cursor:"pointer"},onClick:e[15]||(e[15]=l=>z.value=!0)},{append:r(()=>[t(o,{onClick:e[13]||(e[13]=l=>z.value=!0),size:"small"},{default:r(()=>e[71]||(e[71]=[u("选择")])),_:1})]),_:1},8,["modelValue"])]),_:1}),t(p,{label:"炉批号",prop:"batch"},{default:r(()=>[t(n,{modelValue:i.value.batch,"onUpdate:modelValue":e[16]||(e[16]=l=>i.value.batch=l),maxlength:"48"},null,8,["modelValue"])]),_:1}),t(p,{label:"入库单号",prop:"orderno"},{default:r(()=>[t(n,{modelValue:i.value.orderno,"onUpdate:modelValue":e[17]||(e[17]=l=>i.value.orderno=l),maxlength:"48"},null,8,["modelValue"])]),_:1}),t(p,{label:"牌号",prop:"matMaterial"},{default:r(()=>[t(n,{modelValue:i.value.matMaterial,"onUpdate:modelValue":e[18]||(e[18]=l=>i.value.matMaterial=l),maxlength:"48"},null,8,["modelValue"])]),_:1}),t(p,{label:"规格",prop:"matSpec"},{default:r(()=>[t(n,{modelValue:i.value.matSpec,"onUpdate:modelValue":e[19]||(e[19]=l=>i.value.matSpec=l),maxlength:"48"},null,8,["modelValue"])]),_:1}),t(p,{label:"来料检验批次号",prop:"matRecheckNo"},{default:r(()=>[t(n,{modelValue:i.value.matRecheckNo,"onUpdate:modelValue":e[20]||(e[20]=l=>i.value.matRecheckNo=l),maxlength:"48"},null,8,["modelValue"])]),_:1}),t(p,{label:"化学成分分析-C(%)",prop:"chemC"},{default:r(()=>[t(n,{modelValue:i.value.chemC,"onUpdate:modelValue":e[22]||(e[22]=l=>i.value.chemC=l),placeholder:"请输入C含量",onBlur:e[23]||(e[23]=l=>b("chemC")),suffix:"%"},{append:r(()=>[t(o,{type:"primary",size:"small",onClick:e[21]||(e[21]=l=>b("chemC"))},{default:r(()=>e[72]||(e[72]=[u("格式化")])),_:1})]),_:1},8,["modelValue"]),e[73]||(e[73]=y("div",{class:"el-form-item__tip"},"保留3位小数",-1)),d.chemC?(v(),g("div",fl,c(d.chemC),1)):N("",!0)]),_:1}),t(p,{label:"化学成分分析-Si(%)",prop:"chemSi"},{default:r(()=>[t(n,{modelValue:i.value.chemSi,"onUpdate:modelValue":e[25]||(e[25]=l=>i.value.chemSi=l),placeholder:"请输入Si含量",onBlur:e[26]||(e[26]=l=>b("chemSi")),suffix:"%"},{append:r(()=>[t(o,{type:"primary",size:"small",onClick:e[24]||(e[24]=l=>b("chemSi"))},{default:r(()=>e[74]||(e[74]=[u("格式化")])),_:1})]),_:1},8,["modelValue"]),e[75]||(e[75]=y("div",{class:"el-form-item__tip"},"保留3位小数",-1)),d.chemSi?(v(),g("div",vl,c(d.chemSi),1)):N("",!0)]),_:1}),t(p,{label:"化学成分分析-Mn(%)",prop:"chemMn"},{default:r(()=>[t(n,{modelValue:i.value.chemMn,"onUpdate:modelValue":e[28]||(e[28]=l=>i.value.chemMn=l),placeholder:"请输入Mn含量",onBlur:e[29]||(e[29]=l=>b("chemMn")),suffix:"%"},{append:r(()=>[t(o,{type:"primary",size:"small",onClick:e[27]||(e[27]=l=>b("chemMn"))},{default:r(()=>e[76]||(e[76]=[u("格式化")])),_:1})]),_:1},8,["modelValue"]),e[77]||(e[77]=y("div",{class:"el-form-item__tip"},"保留3位小数",-1)),d.chemMn?(v(),g("div",cl,c(d.chemMn),1)):N("",!0)]),_:1}),t(p,{label:"化学成分分析-P(%)",prop:"chemP"},{default:r(()=>[t(n,{modelValue:i.value.chemP,"onUpdate:modelValue":e[31]||(e[31]=l=>i.value.chemP=l),placeholder:"请输入P含量",onBlur:e[32]||(e[32]=l=>b("chemP")),suffix:"%"},{append:r(()=>[t(o,{type:"primary",size:"small",onClick:e[30]||(e[30]=l=>b("chemP"))},{default:r(()=>e[78]||(e[78]=[u("格式化")])),_:1})]),_:1},8,["modelValue"]),e[79]||(e[79]=y("div",{class:"el-form-item__tip"},"保留3位小数",-1)),d.chemP?(v(),g("div",gl,c(d.chemP),1)):N("",!0)]),_:1}),t(p,{label:"化学成分分析-S(%)",prop:"chemS"},{default:r(()=>[t(n,{modelValue:i.value.chemS,"onUpdate:modelValue":e[34]||(e[34]=l=>i.value.chemS=l),placeholder:"请输入S含量",onBlur:e[35]||(e[35]=l=>b("chemS")),suffix:"%"},{append:r(()=>[t(o,{type:"primary",size:"small",onClick:e[33]||(e[33]=l=>b("chemS"))},{default:r(()=>e[80]||(e[80]=[u("格式化")])),_:1})]),_:1},8,["modelValue"]),e[81]||(e[81]=y("div",{class:"el-form-item__tip"},"保留3位小数",-1)),d.chemS?(v(),g("div",yl,c(d.chemS),1)):N("",!0)]),_:1}),t(p,{label:"化学成分分析-Cr(%)",prop:"chemCr"},{default:r(()=>[t(n,{modelValue:i.value.chemCr,"onUpdate:modelValue":e[37]||(e[37]=l=>i.value.chemCr=l),placeholder:"请输入Cr含量",onBlur:e[38]||(e[38]=l=>b("chemCr")),suffix:"%"},{append:r(()=>[t(o,{type:"primary",size:"small",onClick:e[36]||(e[36]=l=>b("chemCr"))},{default:r(()=>e[82]||(e[82]=[u("格式化")])),_:1})]),_:1},8,["modelValue"]),e[83]||(e[83]=y("div",{class:"el-form-item__tip"},"保留3位小数",-1)),d.chemCr?(v(),g("div",wl,c(d.chemCr),1)):N("",!0)]),_:1}),t(p,{label:"化学成分分析-Ni(%)",prop:"chemNi"},{default:r(()=>[t(n,{modelValue:i.value.chemNi,"onUpdate:modelValue":e[40]||(e[40]=l=>i.value.chemNi=l),placeholder:"请输入Ni含量",onBlur:e[41]||(e[41]=l=>b("chemNi")),suffix:"%"},{append:r(()=>[t(o,{type:"primary",size:"small",onClick:e[39]||(e[39]=l=>b("chemNi"))},{default:r(()=>e[84]||(e[84]=[u("格式化")])),_:1})]),_:1},8,["modelValue"]),e[85]||(e[85]=y("div",{class:"el-form-item__tip"},"保留3位小数",-1)),d.chemNi?(v(),g("div",bl,c(d.chemNi),1)):N("",!0)]),_:1}),t(p,{label:"化学成分分析-Mo(%)",prop:"chemMo"},{default:r(()=>[t(n,{modelValue:i.value.chemMo,"onUpdate:modelValue":e[43]||(e[43]=l=>i.value.chemMo=l),placeholder:"请输入Mo含量",onBlur:e[44]||(e[44]=l=>b("chemMo")),suffix:"%"},{append:r(()=>[t(o,{type:"primary",size:"small",onClick:e[42]||(e[42]=l=>b("chemMo"))},{default:r(()=>e[86]||(e[86]=[u("格式化")])),_:1})]),_:1},8,["modelValue"]),e[87]||(e[87]=y("div",{class:"el-form-item__tip"},"保留3位小数",-1)),d.chemMo?(v(),g("div",Vl,c(d.chemMo),1)):N("",!0)]),_:1}),t(p,{label:"原材料出厂检测日期",prop:"leavefactoryDate"},{default:r(()=>[t(re,{modelValue:i.value.leavefactoryDate,"onUpdate:modelValue":e[45]||(e[45]=l=>i.value.leavefactoryDate=l),type:"date","value-format":"YYYY-MM-DD",placeholder:"选择日期",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(p,{label:"原材料入厂检测日期",prop:"detectionTime"},{default:r(()=>[t(re,{modelValue:i.value.detectionTime,"onUpdate:modelValue":e[46]||(e[46]=l=>i.value.detectionTime=l),type:"date","value-format":"YYYY-MM-DD",placeholder:"选择日期",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(p,{label:"质量证明书",prop:"certificate"},{default:r(()=>[t(_e,{ref_key:"certificateUpload",ref:G,"auto-upload":!1,"on-change":Pe,limit:3,accept:".pdf,.doc,.docx,.xls,.xlsx,.jpg,.jpeg,.png","file-list":[],"show-file-list":!1},{default:r(()=>[t(o,{type:"primary"},{default:r(()=>e[88]||(e[88]=[u("上传质量证明书")])),_:1}),e[89]||(e[89]=y("div",{class:"el-upload__tip"},"支持 pdf、doc、docx、xls、xlsx、jpg、jpeg、png 等格式，最多3个质量证明书",-1))]),_:1},512),i.value.certificate?(v(),g("div",Nl,[(v(!0),g(de,null,me(JSON.parse(i.value.certificate),(l,x)=>(v(),g("div",{key:x,class:"uploaded-file"},[u(c(l.name)+" ",1),t(o,{type:"danger",size:"mini",onClick:ne=>Te(x)},{default:r(()=>e[90]||(e[90]=[u("删除")])),_:2},1032,["onClick"])]))),128))])):N("",!0)]),_:1}),t(p,{label:"录入人",prop:"writer"},{default:r(()=>[t(n,{modelValue:i.value.writer,"onUpdate:modelValue":e[47]||(e[47]=l=>i.value.writer=l),disabled:""},null,8,["modelValue"])]),_:1}),t(p,{label:"录入时间",prop:"writeTime"},{default:r(()=>[t(n,{modelValue:i.value.writeTime,"onUpdate:modelValue":e[48]||(e[48]=l=>i.value.writeTime=l),disabled:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),t(fe,{modelValue:T.value,"onUpdate:modelValue":e[50]||(e[50]=l=>T.value=l),onSelect:ze},null,8,["modelValue"]),t(ve,{modelValue:z.value,"onUpdate:modelValue":e[51]||(e[51]=l=>z.value=l),onSelect:$e},null,8,["modelValue"])]),_:1},8,["title","modelValue"]),t(ie,{title:"质量证明书预览",modelValue:E.value,"onUpdate:modelValue":e[56]||(e[56]=l=>E.value=l),width:"80%","close-on-click-modal":!1,"before-close":te},{footer:r(()=>[t(o,{onClick:e[54]||(e[54]=l=>E.value=!1)},{default:r(()=>e[96]||(e[96]=[u("关闭")])),_:1}),t(o,{type:"primary",onClick:e[55]||(e[55]=l=>H(k.value,_.value))},{default:r(()=>e[97]||(e[97]=[u(" 下载 ")])),_:1})]),default:r(()=>[R.value==="image"?(v(),g("div",Cl,[y("img",{src:k.value,alt:"质量证明书",style:{"max-width":"100%","max-height":"70vh",display:"block",margin:"0 auto"},onError:je},null,40,Sl)])):R.value==="pdf"?(v(),g("div",hl,[y("iframe",{src:k.value,width:"100%",height:"600px",frameborder:"0",onError:Fe},[e[93]||(e[93]=u(" 您的浏览器不支持PDF预览，请")),y("a",{href:k.value,target:"_blank"},"点击此处下载",8,xl)],40,kl)])):(v(),g("div",Ml,[y("div",Ul,[t(Ie,{size:"64",color:"#909399"},{default:r(()=>[t(Ke(Xe))]),_:1}),e[95]||(e[95]=y("p",{style:{margin:"20px 0",color:"#606266"}},"此文件类型不支持在线预览",-1)),t(o,{type:"primary",onClick:e[53]||(e[53]=l=>H(k.value,_.value))},{default:r(()=>e[94]||(e[94]=[u(" 下载文件 ")])),_:1})])]))]),_:1},8,["modelValue"]),t(fe,{modelValue:D.value,"onUpdate:modelValue":e[57]||(e[57]=l=>D.value=l),onSelect:xe},null,8,["modelValue"]),t(nl,{modelValue:B.value,"onUpdate:modelValue":e[58]||(e[58]=l=>B.value=l),onSelect:ge},null,8,["modelValue"]),t(ul,{modelValue:q.value,"onUpdate:modelValue":e[59]||(e[59]=l=>q.value=l),onSelect:ye},null,8,["modelValue"]),t(ve,{modelValue:$.value,"onUpdate:modelValue":e[60]||(e[60]=l=>$.value=l),onSelect:ke},null,8,["modelValue"])])}}},ql=Le($l,[["__scopeId","data-v-0b71be62"]]);export{ql as default};
