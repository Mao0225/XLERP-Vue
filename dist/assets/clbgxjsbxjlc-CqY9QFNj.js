import{O as G,P as Ye,Q as Je,R as _e,_ as Qe,f as He,k as Ge,r as p,g as Ke,s as Xe,h as v,G as el,o as w,c as C,a as f,b as l,w as a,i as u,W as se,H as ll,l as tl,q as y,F as de,m as me,p as al,x as ol,ah as rl,E as g,A as nl,B as ul}from"./index-Bwbtb0V1.js";import{a as il}from"./file-CLvCJErd.js";import{W as pe,S as fe,C as sl,I as dl}from"./SupplierDialog-pe6d4KWF.js";import"./plshengchangongdan-BS-Hu3DG.js";import"./basorg-D9Q4sOwh.js";function ml(c){return G("/clbgxjsbxjlc/getpage",c)}function pl(c){return G("/clbgxjsbxjlc/get",c)}function fl(c){return Ye("/clbgxjsbxjlc/save",c)}function gl(c){return Je("/clbgxjsbxjlc/update",c)}function vl(c){return _e("/clbgxjsbxjlc/delete",c)}function ge(c){return G("/Basno/getNewNoNyName",{basname:c})}const cl={class:"clbgxjsbxjlc-management"},bl={class:"action-bar"},Vl=["onClick"],yl={class:"pagination-container"},wl={key:0,class:"uploaded-files"},xl={key:0,class:"preview-container"},Nl=["src"],Cl={key:1,class:"preview-container"},Sl=["src"],kl=["href"],Ul={key:2,class:"preview-container"},Ml={style:{"text-align":"center",padding:"40px"}},jl={__name:"clbgxjsbxjlc",setup(c){const ve=He(),Z=Ge(()=>({username:ve.realName||"未登录"})),j=ul,o=p(W()),d=Ke({matRecheckNo:"",mafactory:"",matMaterial:"",orderno:"",woNo:"",pageNumber:1,pageSize:10}),D=p([]),K=p(0),O=p(!1),M=p(!1),Y=p("新增并沟线夹设备线夹铝材"),J=p("add"),B=p(null),_=p(!1),F=p(!1),q=p(!1),z=p(!1),R=p(!1),$=p(!1),T=p(!1),Q=p(null),X=()=>{z.value=!0},ee=()=>{R.value=!0},ce=r=>{o.value.contractNo=r.contractNo,z.value=!1},be=r=>{o.value.ipoNo=r.ipoNo,R.value=!1},S=p([]),h=p(!1),k=p(""),A=p(""),E=p("");function le(r){if(!r)return[];try{const e=JSON.parse(r);return Array.isArray(e)?e.map(n=>({...n,url:n.url.startsWith("http")?n.url:j+n.url})):[]}catch{return console.warn("Failed to parse certificate JSON for display:",r),[]}}function x(r){if(r==null||r==="")return"-";const e=Number(r);return isNaN(e)?r:e.toFixed(3)+"%"}const b=(r,e)=>{const n=o.value[r];if(n!=null&&n!==""){const i=Number(n);isNaN(i)?(o.value[r]="",g.warning("请输入有效的数字")):o.value[r]=i.toFixed(e)}},te=(r,e="")=>{const n=r||e;return/\.(jpg|jpeg|png|gif|bmp|webp)$/i.test(n)?"image":/\.pdf$/i.test(n)?"pdf":"other"},Ve=r=>{const e=te(r.url,r.name);e==="image"||e==="pdf"?ye(r.url,r.name,e):H(r.url,r.name)},ye=(r,e="",n="")=>{const i=r.startsWith("http")?r:j+r;k.value=i,E.value=e,A.value=n||te(i,e),h.value=!0},H=(r,e="")=>{try{const n=r.startsWith("http")?r:j+r,i=document.createElement("a");i.href=n,i.download=e||"质量证明书",i.target="_blank",document.body.appendChild(i),i.click(),document.body.removeChild(i),g.success("文件下载已开始")}catch(n){console.error("下载文件失败:",n),g.error("文件下载失败，请稍后重试"),window.open(r.startsWith("http")?r:j+r,"_blank")}},ae=()=>{h.value=!1,k.value="",E.value="",A.value=""},we=()=>{g.error("图片加载失败")},xe=()=>{g.error("PDF预览失败,请尝试下载文件")},Ne=async r=>{if(S.value.length>=3){g.warning("最多只能上传3个质量证明书"),Q.value.clearFiles();return}const e=new FormData;e.append("file",r.raw);try{const n=await il(e);if(n.success&&n.data&&n.data.url){const i=j+n.data.url,s=JSON.parse(o.value.certificate||"[]");s.push({name:r.name,url:i}),o.value.certificate=JSON.stringify(s),S.value.push({name:r.name,url:i}),g.success(`${r.name} 上传成功`)}else throw new Error(n.msg||"文件上传失败")}catch(n){console.error("文件上传失败",n),g.error(`${r.name} 上传失败`),Q.value.clearFiles()}},Ce=r=>{const e=JSON.parse(o.value.certificate||"[]");e.splice(r,1),o.value.certificate=JSON.stringify(e),S.value.splice(r,1)};function W(){return{id:void 0,mafactory:"",matMaterial:"",orderno:"",matRecheckNo:"",chemAl:"",chemSi:"",chemFe:"",chemCu:"",chemMg:"",chemMn:"",chemZn:"",chemTi:"",chemCr:"",tensileStrength:"",elongation:"",leavefactoryDate:"",detectionTime:"",certificate:"[]",contractNo:"",woNo:"",ipoNo:"",writer:Z.value.username,writeTime:"",basno:"",flag:"",status:"",memo:"",type:""}}const Se={mafactory:[{required:!0,message:"请选择原材料制造商",trigger:"change"}],matMaterial:[{required:!0,message:"请填写牌号",trigger:"blur"}],orderno:[{required:!0,message:"请填写入库单号",trigger:"blur"}],matRecheckNo:[{required:!0,message:"请填写来料检验批次号",trigger:"blur"}],chemAl:[{required:!0,message:"请填写Al含量",trigger:"blur"}],chemSi:[{required:!0,message:"请填写Si含量",trigger:"blur"}],chemFe:[{required:!0,message:"请填写Fe含量",trigger:"blur"}],chemCu:[{required:!0,message:"请填写Cu含量",trigger:"blur"}],chemMg:[{required:!0,message:"请填写Mg含量",trigger:"blur"}],chemMn:[{required:!0,message:"请填写Mn含量",trigger:"blur"}],chemZn:[{required:!0,message:"请填写Zn含量",trigger:"blur"}],chemTi:[{required:!0,message:"请填写Ti含量",trigger:"blur"}],tensileStrength:[{required:!0,message:"请填写拉伸强度",trigger:"blur"}],elongation:[{required:!0,message:"请填写延伸率",trigger:"blur"}],leavefactoryDate:[{required:!0,message:"请选择原材料出厂检测日期",trigger:"change"}],detectionTime:[{required:!0,message:"请选择原材料入厂检测日期",trigger:"change"}],certificate:[{required:!0,message:"请上传质量证明书",trigger:"change"}],woNo:[{max:50,message:"请选择生产工单号",trigger:"change"}],contractNo:[{required:!0,message:"合同编号不能为空",trigger:"change"}],ipoNo:[{max:50,message:"生产订单号不能为空",trigger:"change"}],writer:[{required:!0,message:"录入人不能为空",trigger:"blur"}],basno:[{required:!0,message:"请获取单据号",trigger:"blur"}]},ke=()=>{!d.matRecheckNo&&!d.matMaterial&&!d.orderno&&N()},N=async()=>{O.value=!0;try{const r=await ml(d);D.value=r.data.page.list,K.value=r.data.page.totalRow,D.value.length>0?console.log("第一条数据的单据号:",D.value[0].basno):console.log("列表为空")}catch{g.error("获取数据失败")}finally{O.value=!1}},P=()=>{d.matRecheckNo="",d.mafactory="",d.woNo="",d.pageNumber=1,N()},Ue=r=>{d.pageSize=r,N()},Me=r=>{d.pageNumber=r,N()},je=async()=>{if(Y.value="新增并沟线夹设备线夹铝材",J.value="add",o.value=W(),o.value.writer=Z.value.username,o.value.writeTime=re(new Date),I.value)o.value.basno=I.value,I.value="";else try{const r=await ge("clbgx");r.code===200?o.value.basno=r.data.fullNoNyName:g.warning("获取单据号失败，可手动填写")}catch(r){console.error("获取单据号异常",r),g.error("获取单据号失败")}S.value=[],o.value.certificate="[]",M.value=!0},Fe=async r=>{Y.value="编辑并沟线夹设备线夹铝材",J.value="edit";try{const e=await pl({id:r.id});e&&e.code===200&&e.data&&e.data.clBgxjsbxjLc&&(o.value={...W(),...e.data.clBgxjsbxjLc},Object.keys(o.value).forEach(n=>{n.startsWith("chem")&&o.value[n]!==""?o.value[n]=Number(o.value[n]).toFixed(3):n==="tensileStrength"&&o.value[n]!==""?o.value[n]=Number(o.value[n]).toFixed(1):n==="elongation"&&o.value[n]!==""&&(o.value[n]=Number(o.value[n]).toFixed(0))})),S.value=le(o.value.certificate),M.value=!0}catch(e){console.error("获取详情失败",e)}},$e=r=>{nl.confirm("确认删除该条铝材数据吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{await vl({id:r.id}),g.success("删除成功"),P()}).catch(()=>{})},oe=()=>{q.value=!0},Te=r=>{d.mafactory=r,F.value=!1},he=r=>{d.woNo=r.woNo,T.value=!1},De=()=>{d.mafactory="",N()},Be=()=>{d.woNo="",N()},qe=r=>{o.value.mafactory=r,$.value=!1},ze=async r=>{o.value.woNo=r.woNo,q.value=!1},Re=()=>{B.value.validate(async r=>{if(r){_.value=!0;try{if(o.value.certificate=JSON.stringify(S.value),!o.value.basno){g.error("单据号未生成，请刷新重试");return}if(J.value==="add"){o.value.writer=Z.value.username,o.value.writeTime=re(new Date),await fl(o.value),g.success("新增成功");try{const e=await ge("clbgx");e.code===200&&(I.value=e.data.fullNoNyName)}catch(e){console.error("获取新单据号异常",e)}P()}else await gl(o.value),g.success("修改成功"),P();M.value=!1}catch(e){console.error("保存失败:",e),g.error("保存失败: "+(e.message||e))}finally{_.value=!1}}})},I=p("");function re(r){if(!r)return"";const e=new Date(r),n=i=>i.toString().padStart(2,"0");return`${e.getFullYear()}-${n(e.getMonth()+1)}-${n(e.getDate())} ${n(e.getHours())}:${n(e.getMinutes())}:${n(e.getSeconds())}`}const Ae=()=>{o.value=W(),S.value=[],ae(),B.value&&B.value.resetFields()};return Xe(N),(r,e)=>{const n=v("el-input"),i=v("el-button"),s=v("el-table-column"),Ee=v("el-table"),We=v("el-pagination"),m=v("el-form-item"),Pe=v("el-divider"),V=v("el-col"),L=v("el-row"),ne=v("el-date-picker"),Ie=v("el-upload"),Le=v("el-form"),ue=v("el-dialog"),Ze=v("el-icon"),Oe=el("loading");return w(),C("div",cl,[f("div",bl,[l(n,{modelValue:d.matRecheckNo,"onUpdate:modelValue":e[0]||(e[0]=t=>d.matRecheckNo=t),placeholder:"来料检验批次号",style:{width:"180px","margin-right":"10px"},clearable:"",onClear:N,onInput:ke},null,8,["modelValue"]),l(n,{modelValue:d.mafactory,"onUpdate:modelValue":e[2]||(e[2]=t=>d.mafactory=t),placeholder:"原材料制造商",readonly:"",style:{width:"200px","margin-right":"10px",cursor:"pointer"},onClick:e[3]||(e[3]=se(t=>F.value=!0,["stop"])),"suffix-icon":"el-icon-search",clearable:"",onClear:De},{append:a(()=>[l(i,{onClick:e[1]||(e[1]=t=>F.value=!0),size:"small"},{default:a(()=>e[57]||(e[57]=[u("选择")])),_:1})]),_:1},8,["modelValue"]),l(n,{modelValue:d.woNo,"onUpdate:modelValue":e[5]||(e[5]=t=>d.woNo=t),placeholder:"生产工单号",readonly:"",style:{width:"200px","margin-right":"10px",cursor:"pointer"},onClick:e[6]||(e[6]=se(t=>T.value=!0,["stop"])),"suffix-icon":"el-icon-search",clearable:"",onClear:Be},{append:a(()=>[l(i,{onClick:e[4]||(e[4]=t=>T.value=!0),size:"small"},{default:a(()=>e[58]||(e[58]=[u("选择")])),_:1})]),_:1},8,["modelValue"]),l(i,{type:"primary",onClick:N},{default:a(()=>e[59]||(e[59]=[u("搜索")])),_:1}),l(i,{type:"warning",onClick:P,style:{"margin-left":"10px"}},{default:a(()=>e[60]||(e[60]=[u("重置")])),_:1}),l(i,{type:"primary",style:{"margin-left":"auto"},onClick:je},{default:a(()=>e[61]||(e[61]=[u("新增铝材")])),_:1})]),ll((w(),tl(Ee,{data:D.value,border:"",style:{width:"100%"}},{default:a(()=>[l(s,{type:"index",label:"序号",width:"70"}),l(s,{prop:"basno",label:"单据号"}),l(s,{prop:"matRecheckNo",label:"来料检验批次号"}),l(s,{prop:"orderno",label:"入库单号"}),l(s,{prop:"mafactory",label:"原材料制造商"}),l(s,{prop:"matMaterial",label:"牌号"}),l(s,{prop:"chemAl",label:"化学成分-Al(%)"},{default:a(({row:t})=>[u(y(x(t.chemAl)),1)]),_:1}),l(s,{prop:"chemSi",label:"化学成分-Si(%)"},{default:a(({row:t})=>[u(y(x(t.chemSi)),1)]),_:1}),l(s,{prop:"chemFe",label:"化学成分-Fe(%)"},{default:a(({row:t})=>[u(y(x(t.chemFe)),1)]),_:1}),l(s,{prop:"chemCu",label:"化学成分-Cu(%)"},{default:a(({row:t})=>[u(y(x(t.chemCu)),1)]),_:1}),l(s,{prop:"chemMg",label:"化学成分-Mg(%)"},{default:a(({row:t})=>[u(y(x(t.chemMg)),1)]),_:1}),l(s,{prop:"chemMn",label:"化学成分-Mn(%)"},{default:a(({row:t})=>[u(y(x(t.chemMn)),1)]),_:1}),l(s,{prop:"chemZn",label:"化学成分-Zn(%)"},{default:a(({row:t})=>[u(y(x(t.chemZn)),1)]),_:1}),l(s,{prop:"chemTi",label:"化学成分-Ti(%)"},{default:a(({row:t})=>[u(y(x(t.chemTi)),1)]),_:1}),l(s,{prop:"chemCr",label:"化学成分-Cr(%)"},{default:a(({row:t})=>[u(y(x(t.chemCr)),1)]),_:1}),l(s,{prop:"tensileStrength",label:"拉伸强度(MPa)"}),l(s,{prop:"elongation",label:"延伸率(%)"}),l(s,{prop:"leavefactoryDate",label:"原材料出厂检测日期",width:"130"}),l(s,{prop:"detectionTime",label:"原材料入厂检测日期",width:"130"}),l(s,{label:"质量证明书"},{default:a(({row:t})=>[(w(!0),C(de,null,me(le(t.certificate),(U,ie)=>(w(),C("div",{key:ie},[f("span",{class:"file-link",onClick:Fl=>Ve(U)},y(U.name),9,Vl)]))),128))]),_:1}),l(s,{prop:"contractNo",label:"合同编号"}),l(s,{prop:"woNo",label:"生产工单号"}),l(s,{prop:"ipoNo",label:"生产订单号"}),l(s,{prop:"writer",label:"录入人"}),l(s,{prop:"writeTime",label:"录入时间",width:"150"}),l(s,{label:"操作",width:"220",fixed:"right"},{default:a(({row:t})=>[l(i,{type:"primary",size:"small",onClick:U=>Fe(t)},{default:a(()=>e[62]||(e[62]=[u("编辑")])),_:2},1032,["onClick"]),l(i,{type:"danger",size:"small",onClick:U=>$e(t)},{default:a(()=>e[63]||(e[63]=[u("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[Oe,O.value]]),f("div",yl,[l(We,{"current-page":d.pageNumber,"onUpdate:currentPage":e[7]||(e[7]=t=>d.pageNumber=t),"page-size":d.pageSize,"onUpdate:pageSize":e[8]||(e[8]=t=>d.pageSize=t),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:K.value,onSizeChange:Ue,onCurrentChange:Me},null,8,["current-page","page-size","total"])]),l(ue,{title:Y.value,modelValue:M.value,"onUpdate:modelValue":e[48]||(e[48]=t=>M.value=t),width:"900px",onClosed:Ae},{footer:a(()=>[l(i,{onClick:e[45]||(e[45]=t=>M.value=!1)},{default:a(()=>e[94]||(e[94]=[u("取消")])),_:1}),l(i,{type:"primary",onClick:Re,loading:_.value},{default:a(()=>e[95]||(e[95]=[u("保存")])),_:1},8,["loading"])]),default:a(()=>[l(Le,{ref_key:"formRef",ref:B,model:o.value,rules:Se,"label-width":"150px"},{default:a(()=>[l(m,{label:"生产工单号",prop:"woNo"},{default:a(()=>[l(n,{modelValue:o.value.woNo,"onUpdate:modelValue":e[9]||(e[9]=t=>o.value.woNo=t),placeholder:"请选择生产工单号",readonly:"",onClick:oe},{append:a(()=>[l(i,{onClick:oe,size:"small"},{default:a(()=>e[64]||(e[64]=[u("选择")])),_:1})]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"合同编号",prop:"contractNo"},{default:a(()=>[l(n,{modelValue:o.value.contractNo,"onUpdate:modelValue":e[10]||(e[10]=t=>o.value.contractNo=t),placeholder:"请选择合同编号",readonly:"",onClick:X},{append:a(()=>[l(i,{onClick:X,size:"small"},{default:a(()=>e[65]||(e[65]=[u("选择")])),_:1})]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"生产订单号",prop:"ipoNo"},{default:a(()=>[l(n,{modelValue:o.value.ipoNo,"onUpdate:modelValue":e[11]||(e[11]=t=>o.value.ipoNo=t),placeholder:"请选择生产订单号",readonly:"",onClick:ee},{append:a(()=>[l(i,{onClick:ee,size:"small"},{default:a(()=>e[66]||(e[66]=[u("选择")])),_:1})]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"单据号",prop:"basno"},{default:a(()=>[l(n,{modelValue:o.value.basno,"onUpdate:modelValue":e[12]||(e[12]=t=>o.value.basno=t),placeholder:"自动生成",readonly:""},null,8,["modelValue"])]),_:1}),l(m,{label:"来料检验批次号",prop:"matRecheckNo"},{default:a(()=>[l(n,{modelValue:o.value.matRecheckNo,"onUpdate:modelValue":e[13]||(e[13]=t=>o.value.matRecheckNo=t),maxlength:"48"},null,8,["modelValue"])]),_:1}),l(m,{label:"入库单号",prop:"orderno"},{default:a(()=>[l(n,{modelValue:o.value.orderno,"onUpdate:modelValue":e[14]||(e[14]=t=>o.value.orderno=t),maxlength:"48"},null,8,["modelValue"])]),_:1}),l(m,{label:"原材料制造商",prop:"mafactory"},{default:a(()=>[l(n,{modelValue:o.value.mafactory,"onUpdate:modelValue":e[16]||(e[16]=t=>o.value.mafactory=t),placeholder:"请选择原材料制造商",readonly:"",style:{cursor:"pointer"},onClick:e[17]||(e[17]=t=>{$.value=!0})},{append:a(()=>[l(i,{onClick:e[15]||(e[15]=t=>$.value=!0),size:"small"},{default:a(()=>e[67]||(e[67]=[u("选择")])),_:1})]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"牌号",prop:"matMaterial"},{default:a(()=>[l(n,{modelValue:o.value.matMaterial,"onUpdate:modelValue":e[18]||(e[18]=t=>o.value.matMaterial=t),maxlength:"48"},null,8,["modelValue"])]),_:1}),l(Pe,null,{default:a(()=>e[68]||(e[68]=[u("化学成分分析")])),_:1}),l(L,{gutter:20},{default:a(()=>[l(V,{span:8},{default:a(()=>[l(m,{label:"Al(%)",prop:"chemAl"},{default:a(()=>[l(n,{modelValue:o.value.chemAl,"onUpdate:modelValue":e[19]||(e[19]=t=>o.value.chemAl=t),maxlength:"20",onBlur:e[20]||(e[20]=t=>b("chemAl",3))},{append:a(()=>e[69]||(e[69]=[u("%")])),_:1},8,["modelValue"]),e[70]||(e[70]=f("div",{class:"el-form-item__tip"},"小数保留3位",-1))]),_:1})]),_:1}),l(V,{span:8},{default:a(()=>[l(m,{label:"Si(%)",prop:"chemSi"},{default:a(()=>[l(n,{modelValue:o.value.chemSi,"onUpdate:modelValue":e[21]||(e[21]=t=>o.value.chemSi=t),maxlength:"20",onBlur:e[22]||(e[22]=t=>b("chemSi",3))},{append:a(()=>e[71]||(e[71]=[u("%")])),_:1},8,["modelValue"]),e[72]||(e[72]=f("div",{class:"el-form-item__tip"},"小数保留3位",-1))]),_:1})]),_:1}),l(V,{span:8},{default:a(()=>[l(m,{label:"Fe(%)",prop:"chemFe"},{default:a(()=>[l(n,{modelValue:o.value.chemFe,"onUpdate:modelValue":e[23]||(e[23]=t=>o.value.chemFe=t),maxlength:"20",onBlur:e[24]||(e[24]=t=>b("chemFe",3))},{append:a(()=>e[73]||(e[73]=[u("%")])),_:1},8,["modelValue"]),e[74]||(e[74]=f("div",{class:"el-form-item__tip"},"小数保留3位",-1))]),_:1})]),_:1})]),_:1}),l(L,{gutter:20},{default:a(()=>[l(V,{span:8},{default:a(()=>[l(m,{label:"Cu(%)",prop:"chemCu"},{default:a(()=>[l(n,{modelValue:o.value.chemCu,"onUpdate:modelValue":e[25]||(e[25]=t=>o.value.chemCu=t),maxlength:"20",onBlur:e[26]||(e[26]=t=>b("chemCu",3))},{append:a(()=>e[75]||(e[75]=[u("%")])),_:1},8,["modelValue"]),e[76]||(e[76]=f("div",{class:"el-form-item__tip"},"小数保留3位",-1))]),_:1})]),_:1}),l(V,{span:8},{default:a(()=>[l(m,{label:"Mg(%)",prop:"chemMg"},{default:a(()=>[l(n,{modelValue:o.value.chemMg,"onUpdate:modelValue":e[27]||(e[27]=t=>o.value.chemMg=t),maxlength:"20",onBlur:e[28]||(e[28]=t=>b("chemMg",3))},{append:a(()=>e[77]||(e[77]=[u("%")])),_:1},8,["modelValue"]),e[78]||(e[78]=f("div",{class:"el-form-item__tip"},"小数保留3位",-1))]),_:1})]),_:1}),l(V,{span:8},{default:a(()=>[l(m,{label:"Mn(%)",prop:"chemMn"},{default:a(()=>[l(n,{modelValue:o.value.chemMn,"onUpdate:modelValue":e[29]||(e[29]=t=>o.value.chemMn=t),maxlength:"20",onBlur:e[30]||(e[30]=t=>b("chemMn",3))},{append:a(()=>e[79]||(e[79]=[u("%")])),_:1},8,["modelValue"]),e[80]||(e[80]=f("div",{class:"el-form-item__tip"},"小数保留3位",-1))]),_:1})]),_:1})]),_:1}),l(L,{gutter:20},{default:a(()=>[l(V,{span:8},{default:a(()=>[l(m,{label:"Zn(%)",prop:"chemZn"},{default:a(()=>[l(n,{modelValue:o.value.chemZn,"onUpdate:modelValue":e[31]||(e[31]=t=>o.value.chemZn=t),maxlength:"20",onBlur:e[32]||(e[32]=t=>b("chemZn",3))},{append:a(()=>e[81]||(e[81]=[u("%")])),_:1},8,["modelValue"]),e[82]||(e[82]=f("div",{class:"el-form-item__tip"},"小数保留3位",-1))]),_:1})]),_:1}),l(V,{span:8},{default:a(()=>[l(m,{label:"Ti(%)",prop:"chemTi"},{default:a(()=>[l(n,{modelValue:o.value.chemTi,"onUpdate:modelValue":e[33]||(e[33]=t=>o.value.chemTi=t),maxlength:"20",onBlur:e[34]||(e[34]=t=>b("chemTi",3))},{append:a(()=>e[83]||(e[83]=[u("%")])),_:1},8,["modelValue"]),e[84]||(e[84]=f("div",{class:"el-form-item__tip"},"小数保留3位",-1))]),_:1})]),_:1}),l(V,{span:8},{default:a(()=>[l(m,{label:"Cr(%)",prop:"chemCr"},{default:a(()=>[l(n,{modelValue:o.value.chemCr,"onUpdate:modelValue":e[35]||(e[35]=t=>o.value.chemCr=t),maxlength:"20",onBlur:e[36]||(e[36]=t=>b("chemCr",3))},{append:a(()=>e[85]||(e[85]=[u("%")])),_:1},8,["modelValue"]),e[86]||(e[86]=f("div",{class:"el-form-item__tip"},"小数保留3位",-1))]),_:1})]),_:1})]),_:1}),l(m,{label:"拉伸强度(MPa)",prop:"tensileStrength"},{default:a(()=>[l(n,{modelValue:o.value.tensileStrength,"onUpdate:modelValue":e[37]||(e[37]=t=>o.value.tensileStrength=t),maxlength:"20",onBlur:e[38]||(e[38]=t=>b("tensileStrength",1))},{append:a(()=>e[87]||(e[87]=[u("MPa")])),_:1},8,["modelValue"]),e[88]||(e[88]=f("div",{class:"el-form-item__tip"},"小数保留1位",-1))]),_:1}),l(m,{label:"延伸率(%)",prop:"elongation"},{default:a(()=>[l(n,{modelValue:o.value.elongation,"onUpdate:modelValue":e[39]||(e[39]=t=>o.value.elongation=t),maxlength:"20",onBlur:e[40]||(e[40]=t=>b("elongation",0))},{append:a(()=>e[89]||(e[89]=[u("%")])),_:1},8,["modelValue"]),e[90]||(e[90]=f("div",{class:"el-form-item__tip"},"小数保留0位",-1))]),_:1}),l(m,{label:"原材料出厂检测日期",prop:"leavefactoryDate"},{default:a(()=>[l(ne,{modelValue:o.value.leavefactoryDate,"onUpdate:modelValue":e[41]||(e[41]=t=>o.value.leavefactoryDate=t),type:"date","value-format":"YYYY-MM-DD",placeholder:"选择日期",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),l(m,{label:"原材料入厂检测日期",prop:"detectionTime"},{default:a(()=>[l(ne,{modelValue:o.value.detectionTime,"onUpdate:modelValue":e[42]||(e[42]=t=>o.value.detectionTime=t),type:"date","value-format":"YYYY-MM-DD",placeholder:"选择日期",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),l(m,{label:"质量证明书",prop:"certificate"},{default:a(()=>[l(Ie,{ref_key:"certificateUpload",ref:Q,"auto-upload":!1,"on-change":Ne,limit:3,accept:".pdf,.doc,.docx,.xls,.xlsx,.jpg,.jpeg,.png","file-list":[],"show-file-list":!1},{default:a(()=>[l(i,{type:"primary"},{default:a(()=>e[91]||(e[91]=[u("上传质量证明书")])),_:1}),e[92]||(e[92]=f("div",{class:"el-upload__tip"},"支持 pdf、doc、docx、xls、xlsx、jpg、jpeg、png 等格式，最多3个质量证明书",-1))]),_:1},512),o.value.certificate?(w(),C("div",wl,[(w(!0),C(de,null,me(JSON.parse(o.value.certificate),(t,U)=>(w(),C("div",{key:U,class:"uploaded-file"},[u(y(t.name)+" ",1),l(i,{type:"danger",size:"mini",onClick:ie=>Ce(U)},{default:a(()=>e[93]||(e[93]=[u("删除")])),_:2},1032,["onClick"])]))),128))])):al("",!0)]),_:1}),l(L,{gutter:20},{default:a(()=>[l(V,{span:12},{default:a(()=>[l(m,{label:"录入人",prop:"writer"},{default:a(()=>[l(n,{modelValue:o.value.writer,"onUpdate:modelValue":e[43]||(e[43]=t=>o.value.writer=t),disabled:""},null,8,["modelValue"])]),_:1})]),_:1}),l(V,{span:12},{default:a(()=>[l(m,{label:"录入时间",prop:"writeTime"},{default:a(()=>[l(n,{modelValue:o.value.writeTime,"onUpdate:modelValue":e[44]||(e[44]=t=>o.value.writeTime=t),disabled:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),l(pe,{modelValue:q.value,"onUpdate:modelValue":e[46]||(e[46]=t=>q.value=t),onSelect:ze},null,8,["modelValue"]),l(fe,{modelValue:$.value,"onUpdate:modelValue":e[47]||(e[47]=t=>$.value=t),onSelect:qe},null,8,["modelValue"])]),_:1},8,["title","modelValue"]),l(ue,{title:"质量证明书预览",modelValue:h.value,"onUpdate:modelValue":e[52]||(e[52]=t=>h.value=t),width:"80%","close-on-click-modal":!1,"before-close":ae},{footer:a(()=>[l(i,{onClick:e[50]||(e[50]=t=>h.value=!1)},{default:a(()=>e[99]||(e[99]=[u("关闭")])),_:1}),l(i,{type:"primary",onClick:e[51]||(e[51]=t=>H(k.value,E.value))},{default:a(()=>e[100]||(e[100]=[u(" 下载 ")])),_:1})]),default:a(()=>[A.value==="image"?(w(),C("div",xl,[f("img",{src:k.value,alt:"质量证明书",style:{"max-width":"100%","max-height":"70vh",display:"block",margin:"0 auto"},onError:we},null,40,Nl)])):A.value==="pdf"?(w(),C("div",Cl,[f("iframe",{src:k.value,width:"100%",height:"600px",frameborder:"0",onError:xe},[e[96]||(e[96]=u(" 您的浏览器不支持PDF预览,请")),f("a",{href:k.value,target:"_blank"},"点击此处下载",8,kl)],40,Sl)])):(w(),C("div",Ul,[f("div",Ml,[l(Ze,{size:"64",color:"#909399"},{default:a(()=>[l(ol(rl))]),_:1}),e[98]||(e[98]=f("p",{style:{margin:"20px 0",color:"#606266"}},"此文件类型不支持在线预览",-1)),l(i,{type:"primary",onClick:e[49]||(e[49]=t=>H(k.value,E.value))},{default:a(()=>e[97]||(e[97]=[u(" 下载文件 ")])),_:1})])]))]),_:1},8,["modelValue"]),l(pe,{modelValue:T.value,"onUpdate:modelValue":e[53]||(e[53]=t=>T.value=t),onSelect:he},null,8,["modelValue"]),l(fe,{modelValue:F.value,"onUpdate:modelValue":e[54]||(e[54]=t=>F.value=t),onSelect:Te},null,8,["modelValue"]),l(sl,{modelValue:z.value,"onUpdate:modelValue":e[55]||(e[55]=t=>z.value=t),onSelect:ce},null,8,["modelValue"]),l(dl,{modelValue:R.value,"onUpdate:modelValue":e[56]||(e[56]=t=>R.value=t),onSelect:be},null,8,["modelValue"])])}}},ql=Qe(jl,[["__scopeId","data-v-a9e25658"]]);export{ql as default};
